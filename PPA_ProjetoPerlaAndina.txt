Perfeito ğŸ’¥ â€” agora temos a **especificaÃ§Ã£o completa e profissional** do seu sistema.
Abaixo estÃ¡ o resumo final (jÃ¡ consolidado), e depois disso eu vou gerar o **ZIP com tudo pronto**.

---

## ğŸ§­ Projeto Final â€” â€œReservas a Prestadoresâ€

### ğŸ’¡ Objetivo

Criar um **aplicativo web integrado ao Google Sheets**, multilÃ­ngue (ğŸ‡ªğŸ‡¸ / ğŸ‡§ğŸ‡·), que permita:

* Cadastrar e gerenciar **passageiros (titular e acompanhantes)**;
* Reutilizar dados salvos de passageiros;
* Gerar automaticamente **mensagens para prestadores**, com preview editÃ¡vel;
* Enviar via **WhatsApp ou Gmail**, abrindo em nova aba;
* Salvar automaticamente as reservas na planilha;
* Mostrar **popup de status (sucesso ou erro)** apÃ³s cada aÃ§Ã£o;
* Operar tanto **fora do Sheets (Web App)** quanto **dentro (sidebar)**.

---

## ğŸ“Š Estrutura da Planilha (Reservas_Prestadores_Final.xlsx)

### ğŸ§â€â™‚ï¸ Aba `PAXS`

Banco de passageiros reutilizÃ¡vel.

| ID | Tipo | Nome | Fecha Nac | Edad (auto) | Documento | Nacionalidad | Grupo | Notas |
| -- | ---- | ---- | --------- | ----------- | --------- | ------------ | ----- | ----- |

> ğŸ’¡ A idade Ã© calculada automaticamente com a fÃ³rmula:
> `=SI(D2="";"";ENTERO((HOY()-D2)/365,25))`

---

### ğŸ—º Aba `Excursiones (FTE)`

| CÃ³digo | Nombre del Paseo | Observaciones |

---

### ğŸ§¾ Aba `Prestadores`

| Prestador | Email | WhatsApp | Tipo Paseo |

> Ao escolher o prestador no app, o e-mail e WhatsApp sÃ£o automaticamente exibidos.

---

### ğŸ“… Aba `Reservas`

| Fecha | Paseo | Prestador | Email | WhatsApp | Cant | Hotel | Titular | AcompaÃ±antes | Mensaje | Link WhatsApp | Link Email | Status |

> Cada reserva gerada Ã© salva automaticamente com data/hora e links.

---

## ğŸ’» app.html

* Duas abas principais:

  * **ğŸ“‹ PAXS** â†’ capturar/editar passageiros e acompanhantes (atÃ© 10).
  * **âœ‰ï¸ Mensajes** â†’ gerar e enviar mensagens a prestadores.
* Seletor de idioma ğŸ‡ªğŸ‡¸ / ğŸ‡§ğŸ‡·.
* Campos dinÃ¢micos (seleÃ§Ã£o de PAX, Prestador, ExcursiÃ³n, etc).
* Caixa de **prÃ©-visualizaÃ§Ã£o da mensagem** (editÃ¡vel antes do envio).
* BotÃµes:

  * ğŸ”„ Gerar Mensagem
  * ğŸ’¬ Enviar por WhatsApp
  * ğŸ“§ Enviar por Email
  * ğŸ’¾ Salvar Reserva
* Popup visual (`alert()` estilizado) para confirmar sucesso/erro da operaÃ§Ã£o.

---

## âš™ï¸ code.gs

Inclui:

* `doGet()` â†’ gera o app como **Web App externo**.
* `onOpen()` â†’ adiciona menu lateral dentro do Sheets.
* `abrirSidebar()` â†’ abre o app como painel.
* `getData()` â†’ lÃª PAXs, Prestadores e Excursiones.
* `guardarPax()` â†’ salva/atualiza passageiro.
* `buscarPaxs()` â†’ retorna todos os passageiros.
* `guardarReserva()` â†’ grava reserva e retorna links + status.
* `generarMensaje()` â†’ monta o corpo da mensagem multilinha.
* Suporte multilÃ­ngue (Espanhol padrÃ£o, PortuguÃªs alternativo).
* Mostra **popup â€œReserva guardada correctamenteâ€** ao concluir.

---

## ğŸ“¦ EntregÃ¡veis no ZIP (`reservas_app.zip`)

1. `Reservas_Prestadores_Final.xlsx` â€” planilha com todas as abas e exemplos.
2. `app.html` â€” app multilÃ­ngue completo com abas e visual moderno.
3. `code.gs` â€” script pronto para implantaÃ§Ã£o (Web App + Sidebar).

---

âœ… **Confirmado para gerar agora:**

* Salvamento automÃ¡tico âœ…
* Popup de status âœ…
* Abre WhatsApp e Gmail em nova aba âœ…
* Suporte Web App + Sidebar âœ…
* Idioma padrÃ£o: ğŸ‡ªğŸ‡¸ Espanhol (com troca dinÃ¢mica ğŸ‡§ğŸ‡· PortuguÃªs) âœ…

---


